#=  Produce a sequence of DNA strings the corresponds to an allele frequency vector
under the infinite-sites model.  Each allele corresponds to a different DNA string
that differs from the AAA...AA string at one locus.
=#

@doc """function pseudo_dna( frequencies::Vector{Int64} )
frequences is a vector of positive integers corresponding to allele frequencies.
Returns a list of sum(frequences) strings where each string is the same length as frequences.
Each string is a sequences of "A"s followed by a "C" followed by another sequence of "A"s.
"""

function pseudo_dna( frequencies::Vector{Int64} )
  N = sum(frequencies)
  k = length(frequencies)
  base = string()
  for i = 1:k
    base = string(base,"A")
  end
  string_list = AbstractString[]
  i = 1
  while i <= k
    current = base
    current = string(base[1:(i-1)], "C", base[(i+1):end] )
    for j = 1:frequencies[i]
      push!(string_list,current)
    end
    i += 1
  end
  string_list
end

@doc """function write_dna_file( file_name::AbstractString, frequencies::Vector{Int64} )
Write the strings generated by pseudo_dna to a file in fasta format.
Each string is preceded by an identifier of the form ">seq$i" where i is the strong number.
"""
      
function write_dna_file( file_name::AbstractString, frequencies::Vector{Int64} )
  fp = open( file_name, "w" )
  string_list = pseudo_dna(frequencies)
  i = 1
  for s in string_list
    write(fp, ">seq$i", "\n" )
    write(fp, s, "\n" )
    i += 1
  end
  close(fp)
end

